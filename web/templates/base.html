<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}SoulScript Engine{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            forge: {
              bg:      '#0f0f14',
              card:    '#1a1a24',
              border:  '#2a2a3a',
              accent:  '#6366f1',
              accent2: '#818cf8',
              highlight:'#22d3ee',
              warn:    '#f59e0b',
              danger:  '#ef4444',
              success: '#10b981',
              muted:   '#71717a',
            }
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body class="bg-forge-bg text-zinc-200 min-h-screen">
  <div class="flex min-h-screen">
    <!-- ═══ Sidebar Nav ═══ -->
    <nav class="main-nav" id="main-nav">
      <div class="nav-logo">
        <div class="nav-logo-full">
          <span class="nav-logo-diamond">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M12 3L20 7.5V16.5L12 21L4 16.5V7.5L12 3Z" stroke="#6366f1" stroke-width="1.5" stroke-linejoin="round"/>
              <path d="M12 7L13.5 10.5L17 12L13.5 13.5L12 17L10.5 13.5L7 12L10.5 10.5Z" fill="#818cf8"/>
              <circle cx="12" cy="12" r="1.5" fill="#c7d2fe"/>
            </svg>
          </span>
          <div>
            <div class="nav-logo-text">Soul Script</div>
            <div class="nav-logo-sub">Chat Engine</div>
          </div>
        </div>
        <button class="nav-toggle-btn" onclick="toggleMainNav()" title="Toggle sidebar">☰</button>
      </div>

      <div class="nav-links-wrap">
        <a href="/chat" class="nav-link {% if page == 'chat' %}active{% endif %}">
          <span class="nav-icon">◎</span><span class="nav-label">Chat</span>
        </a>
        <a href="/profiles" class="nav-link {% if page == 'profiles' %}active{% endif %}">
          <span class="nav-icon">♢</span><span class="nav-label">Profiles</span>
        </a>
        <a href="/vault" class="nav-link {% if page == 'vault' %}active{% endif %}">
          <span class="nav-icon">◆</span><span class="nav-label">Memory Vault</span>
        </a>
        <a href="/knowledge" class="nav-link {% if page == 'knowledge' %}active{% endif %}">
          <span class="nav-icon">✎</span><span class="nav-label">Knowledge</span>
        </a>
        <a href="/tools" class="nav-link {% if page == 'tools' %}active{% endif %}">
          <span class="nav-icon">⚒</span><span class="nav-label">Tools</span>
        </a>
        <div class="border-t border-forge-border my-3 nav-divider"></div>
        <a href="/settings" class="nav-link {% if page == 'settings' %}active{% endif %}">
          <span class="nav-icon">⚙</span><span class="nav-label">Settings</span>
        </a>
        <a href="/about" class="nav-link {% if page == 'about' %}active{% endif %}">
          <span class="nav-icon">ℹ</span><span class="nav-label">About</span>
        </a>
      </div>

      <div class="nav-footer">
        <p class="text-xs text-forge-muted">v0.2 · SoulScript Engine</p>
      </div>
    </nav>

    <!-- ═══ Main Content ═══ -->
    <main class="main-content" id="main-content">
      {% block content %}{% endblock %}
    </main>
  </div>

  <script>
    function toggleMainNav() {
      const nav = document.getElementById('main-nav');
      const main = document.getElementById('main-content');
      nav.classList.toggle('collapsed');
      main.classList.toggle('nav-collapsed');
      localStorage.setItem('nav_collapsed', nav.classList.contains('collapsed') ? '1' : '0');
    }
    // Restore collapsed state
    if (localStorage.getItem('nav_collapsed') === '1') {
      document.getElementById('main-nav').classList.add('collapsed');
      document.getElementById('main-content').classList.add('nav-collapsed');
    }
  </script>
</body>
</html>
